---
patterns:
  - push:
      operands:
        - $or:
            include_list:
              - rax
            exclude_list:
              - rex
  - call:
      times:
        min: 3
        max: 9
  - nopw
  - $not:
      inst:
        - jump
        - jq
      times:
        min: 1
        max: 10
  - $or:
      include_list:
        - push
        - call
      times:
        min: 3
        max: 6

      exclude_list:
        - sub

  - $not:
      inst:
        - push
  - mov:
      times:
        min: 2
        max: 2
      operands:
        - $or:
            include_list:
              - rsi
              - rbp
              - fs:0x28
              - rax
            exclude_list:
              - rsd
