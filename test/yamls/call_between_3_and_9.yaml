---
patterns:
  - push:
      operands:
        - $any:
            include_list:
              ops:
                - "%rax"
            exclude_list:
              ops:
                - "%rex"
  - call:
      times:
        min: 3
        max: 9
  - nopw
  - $not:
      inst:
        - jump
        - jq
      times:
        min: 1
        max: 10
  - $any:
      include_list:
        inst:
          - push
          - call
      times:
        min: 3
        max: 6

      exclude_list:
        inst:
          - sub

  - $not:
      inst:
        - push
  - mov:
      times:
        min: 2
        max: 2
      operands:
        - $any:
            include_list:
              ops:
                - "%rsi"
                - "%rbp"
                - "%fs:0x28"
                - "%rax"
            exclude_list:
              ops:
                - "%rsd"
