---
patterns:
  - push:
      operands:
        include_list:
          inst:
            - "rax"
        exclude_list:
          inst:
            - "rex"
  - call:
      times:
        min: 3
        max: 9
  - nopw
  - $not:
      inst:
        - jump
        - jq
      times:
        min: 1
        max: 10
  - $any:
      include_list:
        inst:
          - push
          - call
      times:
        min: 3
        max: 6

      exclude_list:
        inst:
          - sub

  - $not:
      inst:
        - push
  - mov:
      times:
        min: 2
        max: 2
      operands:
        include_list:
          inst:
            - "rsi"
            - "rbp"
            - "fs:0x28"
            - "rax"
        exclude_list:
          inst:
            - "rsd"
